<!DOCTYPE html>
<html>

<head>
    <script src="newsquirrelly.js"></script>
</head>

<body>
    <div id="result1"></div>
    <p>--------------------</p>
    <div id="functionResult"></div>

<textarea oninput="comp()" id="input" style="width: 200px; height: 200px;">
Hey guys, welcome to Squirrelly! Feel free to hack, or style this page, cause it's ugly.
{{helper(params) randomid}}
{{helper2(params2)}}

{{@ hhey|hey}}
{{hey | hi | hey | }}
{{@hi:hey}}
{{@../hey}}
{{hi hey}}
{{hi * 4}}
{{hi(parameters) id}}
{{/ hey}}
{{#block}}
</textarea>
    <div id="output"></div>
    <script>
        Sqrl.registerFilter("reverse", function (str) {
            var out = ''
            for (var i = str.length - 1; i >= 0; i--) {
                out += str.charAt(i)
            }
            return out || str
        })

        Sqrl.defaultFilters.reverse = true
        Sqrl.autoEscape(true)


        function comp() {
            console.clear()
            console.time("comp")
            let newtemplatefunction = Sqrl.Precompile(document.getElementById("input").value)

            console.log("Function returned by comp: ")
            console.log(newtemplatefunction.toString())
            let result = newtemplatefunction({
                htmlstuff: "<script>alert('hey')<\/script><p>alert('hey')</p><p>alert('hey')</p><p>alert('hey')</p>",
                arr: ["Hey", "<p>Malicious XSS</p>", "Hey", 3, 3*4]
            }, Sqrl)
            document.getElementById("result1").innerHTML = result
            console.timeEnd("comp")
            document.getElementById("funcitonResult").innerHTML = newtemplatefunction

        }
        comp()
    </script>
    <p>Helper is called with (args, content, blocks, options)</p>
</body>

</html>